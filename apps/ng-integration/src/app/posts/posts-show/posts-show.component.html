<div>
    <lyxs-active path="entities.posts" #activePostComponent>
        <ng-container *ngIf="activePostComponent.active$ | async as post">
            <div class="font-bold">{{ post.title }}</div>
            <div class="mt-3">{{ post.body }}</div>

            <lyxs-one path="entities.users" [id]="post.userId" #oneUser>
                <ng-container *ngIf="oneUser.one$ | async as user">
                    <div class="mt-3">
                        &mdash; {{ user.name }} {{ user.email }}
                    </div>
                </ng-container>
            </lyxs-one>
        </ng-container>

        <div class="loading">
            <div class="p-2 bg-gray-400 rounded">LOADING...</div>
        </div>
    </lyxs-active>
</div>

<div class="mt-6">
    <lyxs-collection path="entities.comments" #comments>
        <div class="border-l-4 border-gray-600 pl-3 -my-3 text-gray-600" *ngIf="comments.loaded$ | async">
            <div class="mb-3">Comments:</div>
            <ng-container *ngFor="let comment of comments.all$ | async; trackBy:comments.trackByKey()">
                <ng-container *ngIf="comment.postId === (activePostComponent.activeId$ | async)">
                    <div class="py-3">
                        <div class="font-bold">{{ comment.email }} {{ comment.name }}</div>
                        <div>{{ comment.body }}</div>
                    </div>
                </ng-container>
            </ng-container>
        </div>
    </lyxs-collection>
</div>
